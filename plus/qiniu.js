/* Fengs.JS v3.0 2017-03-17 16:09:21 */ 
Fengs.add("plus/qiniu-sdk",function(){function t(e,t,n){var r=new Date;r.setTime(r.getTime()+n*24*60*60*1e3);var i="; expires="+r.toGMTString();document.cookie=e+"="+t+i+"; path=/"}function n(e){var t=e+"=",n=document.cookie.split(";");for(var r=0,i=n.length;r<i;r++){var s=n[r];while(s.charAt(0)===" ")s=s.substring(1,s.length);if(s.indexOf(t)===0)return s.substring(t.length,s.length)}return null}function r(){function n(t,n){var r="[qiniu-js-sdk]["+t+"]",i=r;for(var s=0;s<n.length;s++)typeof n[s]=="string"?i+=" "+n[s]:i+=" "+e.stringifyJSON(n[s]);e.detectIEVersion()?console.log(i):(n.unshift(r),console.log.apply(console,n)),document.getElementById("qiniu-js-sdk-log")&&(document.getElementById("qiniu-js-sdk-log").innerHTML+="<p>"+i+"</p>")}function r(e){var r=e.toLowerCase();t[r]=function(){if(window.console&&window.console.log&&t.level>=t[e]){var i=Array.prototype.slice.call(arguments);n(r,i)}}}var e=this;this.detectIEVersion=function(){var e=4,t=document.createElement("div"),n=t.getElementsByTagName("i");while(t.innerHTML="<!--[if gt IE "+e+"]><i></i><![endif]-->",n[0])e++;return e>4?e:!1};var t={MUTE:0,FATA:1,ERROR:2,WARN:3,INFO:4,DEBUG:5,TRACE:6,level:0};for(var i in t)t.hasOwnProperty(i)&&typeof t[i]=="number"&&!t.hasOwnProperty(i.toLowerCase())&&r(i);var s;window.location.protocol==="https:"?s="https://up.qbox.me":s="http://upload.qiniu.com";var o=["http://upload.qiniu.com","http://up.qiniu.com"],u=0;this.resetUploadUrl=function(){if(window.location.protocol==="https:")s="https://up.qbox.me";else{var e=u%o.length;s=o[e],u++}t.debug("resetUploadUrl: "+s)},this.resetUploadUrl(),this.isImage=function(e){return e=e.split(/[?#]/)[0],/\.(png|jpg|jpeg|gif|bmp)$/i.test(e)},this.getFileExtension=function(e){var t=e.split("."),n;return t.length===1||t[0]===""&&t.length===2?n="":n=t.pop().toLowerCase(),n},this.utf8_encode=function(e){if(e===null||typeof e=="undefined")return"";var t=e+"",n="",r,i,s=0;r=i=0,s=t.length;for(var o=0;o<s;o++){var u=t.charCodeAt(o),a=null;if(u<128)i++;else if(u>127&&u<2048)a=String.fromCharCode(u>>6|192,u&63|128);else if(u&63488^!0)a=String.fromCharCode(u>>12|224,u>>6&63|128,u&63|128);else{if(u&64512^!0)throw new RangeError("Unmatched trail surrogate at "+o);var f=t.charCodeAt(++o);if(f&64512^!0)throw new RangeError("Unmatched lead surrogate at "+(o-1));u=((u&1023)<<10)+(f&1023)+65536,a=String.fromCharCode(u>>18|240,u>>12&63|128,u>>6&63|128,u&63|128)}a!==null&&(i>r&&(n+=t.slice(r,i)),n+=a,r=i=o+1)}return i>r&&(n+=t.slice(r,s)),n},this.base64_encode=function(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n,r,i,s,o,u,a,f,l=0,c=0,h="",p=[];if(!e)return e;e=this.utf8_encode(e+"");do n=e.charCodeAt(l++),r=e.charCodeAt(l++),i=e.charCodeAt(l++),f=n<<16|r<<8|i,s=f>>18&63,o=f>>12&63,u=f>>6&63,a=f&63,p[c++]=t.charAt(s)+t.charAt(o)+t.charAt(u)+t.charAt(a);while(l<e.length);h=p.join("");switch(e.length%3){case 1:h=h.slice(0,-2)+"==";break;case 2:h=h.slice(0,-1)+"="}return h},this.URLSafeBase64Encode=function(e){return e=this.base64_encode(e),e.replace(/\//g,"_").replace(/\+/g,"-")},this.createAjax=function(e){var t={};return window.XMLHttpRequest?t=new XMLHttpRequest:t=new ActiveXObject("Microsoft.XMLHTTP"),t},this.parseJSON=function(e){if(window.JSON&&window.JSON.parse)return window.JSON.parse(e);var t=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,n=String(e);return t.lastIndex=0,t.test(n)&&(n=n.replace(t,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),eval("("+n+")")},this.stringifyJSON=function(t){if(window.JSON&&window.JSON.stringify)return window.JSON.stringify(t);switch(typeof t){case"string":return'"'+t.replace(/(["\\])/g,"\\$1")+'"';case"array":return"["+t.map(e.stringifyJSON).join(",")+"]";case"object":if(t instanceof Array){var n=[],r=t.length;for(var i=0;i<r;i++)n.push(e.stringifyJSON(t[i]));return"["+n.join(",")+"]"}if(t===null)return"null";var s=[];for(var o in t)t.hasOwnProperty(o)&&s.push(e.stringifyJSON(o)+":"+e.stringifyJSON(t[o]));return"{"+s.join(",")+"}";case"number":return t;case!1:return t;case"boolean":return t}},this.trim=function(e){return e===null?"":e.replace(/^\s+|\s+$/g,"")},this.uploader=function(n){var r=function(){var t=e.detectIEVersion(),r,i,s,o=mOxie.Env.browser==="Safari"&&mOxie.Env.version<=5&&mOxie.Env.os==="Windows"&&mOxie.Env.osVersion==="7"||mOxie.Env.browser==="Safari"&&mOxie.Env.os==="iOS"&&mOxie.Env.osVersion==="7";t&&t<=9&&n.chunk_size&&n.runtimes.indexOf("flash")<0?n.chunk_size=0:o?n.chunk_size=0:(r=20,i=4<<r,s=plupload.parseSize(n.chunk_size),s>i&&(n.chunk_size=i))},i=function(r){if(n.uptoken){e.token=n.uptoken;return}if(n.uptoken_url){t.debug("get uptoken from: ",e.uptoken_url);var i=e.createAjax();i.open("GET",e.uptoken_url,!1),i.setRequestHeader("If-Modified-Since","0"),i.send();if(i.status===200){var s=e.parseJSON(i.responseText);e.token=s.uptoken,t.debug("get new uptoken: ",s.uptoken)}else t.error("get uptoken error: ",i.responseText);return}if(n.uptoken_func){t.debug("get uptoken from uptoken_func"),e.token=n.uptoken_func(r),t.debug("get new uptoken: ",e.token);return}t.error("one of [uptoken, uptoken_url, uptoken_func] settings in options is required!")},u=function(t,r,i){var s="",o=!1;if(!n.save_key){o=t.getOption&&t.getOption("unique_names"),o=o||t.settings&&t.settings.unique_names;if(o){var u=e.getFileExtension(r.name);s=u?r.id+"."+u:r.id}else typeof i=="function"?s=i(t,r):s=r.name}return s};n.log_level&&(t.level=n.log_level);if(!n.domain)throw"domain setting in options is required!";if(!n.browse_button)throw"browse_button setting in options is required!";if(!n.uptoken&&!n.uptoken_url&&!n.uptoken_func)throw"one of [uptoken, uptoken_url, uptoken_func] settings in options is required!";t.debug("init uploader start"),t.debug("environment: ",mOxie.Env),t.debug("userAgent: ",navigator.userAgent);var a={},f=n.init&&n.init.Error,l=n.init&&n.init.FileUploaded;n.init.Error=function(){},n.init.FileUploaded=function(){},e.uptoken_url=n.uptoken_url,e.token="",e.key_handler=typeof n.init.Key=="function"?n.init.Key:"",this.domain=n.domain;var c="",h={isResumeUpload:!1,resumeFilesize:0,startTime:"",currentTime:""};r(),t.debug("invoke reset_chunk_size()"),t.debug("op.chunk_size: ",n.chunk_size),plupload.extend(a,n,{url:s,multipart_params:{token:""}}),t.debug("option: ",a);var p=new plupload.Uploader(a);t.debug("new plupload.Uploader(option)"),p.bind("Init",function(e,r){t.debug("Init event activated"),n.get_new_uptoken||i(null)}),t.debug("bind Init event"),p.bind("FilesAdded",function(n,r){t.debug("FilesAdded event activated");var i=n.getOption&&n.getOption("auto_start");i=i||n.settings&&n.settings.auto_start,t.debug("auto_start: ",i),t.debug("files: ",r);var s=function(){return mOxie.Env.OS.toLowerCase()==="ios"?!0:!1};if(s())for(var o=0;o<r.length;o++){var u=r[o],a=e.getFileExtension(u.name);u.name=u.id+"."+a}i&&setTimeout(function(){n.start(),t.debug("invoke up.start()")},0),n.refresh()}),t.debug("bind FilesAdded event"),p.bind("BeforeUpload",function(r,o){t.debug("BeforeUpload event activated"),o.speed=o.speed||0,c="",n.get_new_uptoken&&i(o);var a=function(r,i,o){h.startTime=(new Date).getTime();var a;n.save_key?a={token:e.token}:a={key:u(r,i,o),token:e.token},t.debug("directUpload multipart_params_obj: ",a);var l=n.x_vars;if(l!==undefined&&typeof l=="object")for(var c in l)l.hasOwnProperty(c)&&(typeof l[c]=="function"?a["x:"+c]=l[c](r,i):typeof l[c]!="object"&&(a["x:"+c]=l[c]));r.setOption({url:s,multipart:!0,chunk_size:f()?n.max_file_size:undefined,multipart_params:a})},f=function(){var e=navigator.userAgent.toLowerCase();return(e.match(/MicroMessenger/i)||mOxie.Env.browser==="QQBrowser"||e.match(/V1_AND_SQ/i))&&mOxie.Env.OS.toLowerCase()==="android"?!0:!1},l=r.getOption&&r.getOption("chunk_size");l=l||r.settings&&r.settings.chunk_size,t.debug("uploader.runtime: ",p.runtime),t.debug("chunk_size: ",l);if(p.runtime!=="html5"&&p.runtime!=="flash"||!l)t.debug("directUpload because uploader.runtime !== 'html5' || uploader.runtime !== 'flash' || !chunk_size"),a(r,o,e.key_handler);else if(o.size<l||f())t.debug("directUpload because file.size < chunk_size || is_android_weixin_or_qq()"),a(r,o,e.key_handler);else{var d=localStorage.getItem(o.name),v=l;if(d){d=e.parseJSON(d);var m=(new Date).getTime(),g=d.time||0,y=864e5;m-g<y?d.percent!==100?o.size===d.total?(o.percent=d.percent,o.loaded=d.offset,c=d.ctx,h.isResumeUpload=!0,h.resumeFilesize=d.offset,d.offset+v>o.size&&(v=o.size-d.offset)):localStorage.removeItem(o.name):localStorage.removeItem(o.name):localStorage.removeItem(o.name)}h.startTime=(new Date).getTime(),r.setOption({url:s+"/mkblk/"+v,multipart:!1,chunk_size:l,required_features:"chunks",headers:{Authorization:"UpToken "+e.token},multipart_params:{}})}}),t.debug("bind BeforeUpload event"),p.bind("UploadProgress",function(e,n){t.trace("UploadProgress event activated"),h.currentTime=(new Date).getTime();var r=h.currentTime-h.startTime,i=n.loaded||0;h.isResumeUpload&&(i=n.loaded-h.resumeFilesize),n.speed=(i/r*1e3).toFixed(0)||0}),t.debug("bind UploadProgress event"),p.bind("ChunkUploaded",function(n,r,i){t.debug("ChunkUploaded event activated"),t.debug("file: ",r),t.debug("info: ",i);var o=e.parseJSON(i.response);t.debug("res: ",o),c=c?c+","+o.ctx:o.ctx;var u=i.total-i.offset,a=n.getOption&&n.getOption("chunk_size");a=a||n.settings&&n.settings.chunk_size,u<a&&(n.setOption({url:s+"/mkblk/"+u}),t.debug("up.setOption url: ",s+"/mkblk/"+u)),localStorage.setItem(r.name,e.stringifyJSON({ctx:c,percent:r.percent,total:i.total,offset:i.offset,time:(new Date).getTime()}))}),t.debug("bind ChunkUploaded event");var d=o.length,v=function(t){return d-->0?(setTimeout(function(){e.resetUploadUrl(),t.status=plupload.QUEUED,p.stop(),p.start()},0),!0):(d=o.length,!1)};return p.bind("Error",function(n){return function(r,i){t.error("Error event activated"),t.error("err: ",i);var s="",o=i.file;if(o){switch(i.code){case plupload.FAILED:s="\u4e0a\u4f20\u5931\u8d25。\u8bf7\u7a0d\u540e\u518d\u8bd5。";break;case plupload.FILE_SIZE_ERROR:var u=r.getOption&&r.getOption("max_file_size");u=u||r.settings&&r.settings.max_file_size,s="\u6d4f\u89c8\u5668\u6700\u5927\u53ef\u4e0a\u4f20"+u+"。\u66f4\u5927\u6587\u4ef6\u8bf7\u4f7f\u7528\u547d\u4ee4\u884c\u5de5\u5177。";break;case plupload.FILE_EXTENSION_ERROR:s="\u6587\u4ef6\u9a8c\u8bc1\u5931\u8d25。\u8bf7\u7a0d\u540e\u91cd\u8bd5。";break;case plupload.HTTP_ERROR:if(i.response===""){s=i.message||"\u672a\u77e5\u7f51\u7edc\u9519\u8bef。";if(!v(o))return;break}var a=e.parseJSON(i.response),f=a.error;switch(i.status){case 400:s="\u8bf7\u6c42\u62a5\u6587\u683c\u5f0f\u9519\u8bef。";break;case 401:s="\u5ba2\u6237\u7aef\u8ba4\u8bc1\u6388\u6743\u5931\u8d25。\u8bf7\u91cd\u8bd5\u6216\u63d0\u4ea4\u53cd\u9988。";break;case 405:s="\u5ba2\u6237\u7aef\u8bf7\u6c42\u9519\u8bef。\u8bf7\u91cd\u8bd5\u6216\u63d0\u4ea4\u53cd\u9988。";break;case 579:s="\u8d44\u6e90\u4e0a\u4f20\u6210\u529f，\u4f46\u56de\u8c03\u5931\u8d25。";break;case 599:s="\u7f51\u7edc\u8fde\u63a5\u5f02\u5e38。\u8bf7\u91cd\u8bd5\u6216\u63d0\u4ea4\u53cd\u9988。";if(!v(o))return;break;case 614:s="\u6587\u4ef6\u5df2\u5b58\u5728。";try{a=e.parseJSON(a.error),f=a.error||"file exists"}catch(l){f=a.error||"file exists"}break;case 631:s="\u6307\u5b9a\u7a7a\u95f4\u4e0d\u5b58\u5728。";break;case 701:s="\u4e0a\u4f20\u6570\u636e\u5757\u6821\u9a8c\u51fa\u9519。\u8bf7\u91cd\u8bd5\u6216\u63d0\u4ea4\u53cd\u9988。";break;default:s="\u672a\u77e5\u9519\u8bef。";if(!v(o))return}s=s+"("+i.status+"："+f+")";break;case plupload.SECURITY_ERROR:s="\u5b89\u5168\u914d\u7f6e\u9519\u8bef。\u8bf7\u8054\u7cfb\u7f51\u7ad9\u7ba1\u7406\u5458。";break;case plupload.GENERIC_ERROR:s="\u4e0a\u4f20\u5931\u8d25。\u8bf7\u7a0d\u540e\u518d\u8bd5。";break;case plupload.IO_ERROR:s="\u4e0a\u4f20\u5931\u8d25。\u8bf7\u7a0d\u540e\u518d\u8bd5。";break;case plupload.INIT_ERROR:s="\u7f51\u7ad9\u914d\u7f6e\u9519\u8bef。\u8bf7\u8054\u7cfb\u7f51\u7ad9\u7ba1\u7406\u5458。",p.destroy();break;default:s=i.message+i.details;if(!v(o))return}n&&n(r,i,s)}r.refresh()}}(f)),t.debug("bind Error event"),p.bind("FileUploaded",function(r){return function(i,o,a){t.debug("FileUploaded event activated"),t.debug("file: ",o),t.debug("info: ",a);var f=function(t,i,s){if(n.downtoken_url){var o=e.createAjax();o.open("POST",n.downtoken_url,!0),o.setRequestHeader("Content-type","application/x-www-form-urlencoded"),o.onreadystatechange=function(){if(o.readyState===4)if(o.status===200){var n;try{n=e.parseJSON(o.responseText)}catch(u){throw"invalid json format"}var a={};plupload.extend(a,e.parseJSON(s),n),r&&r(t,i,e.stringifyJSON(a))}else p.trigger("Error",{status:o.status,response:o.responseText,file:i,code:plupload.HTTP_ERROR})},o.send("key="+e.parseJSON(s).key+"&domain="+n.domain)}else r&&r(t,i,s)},l=e.parseJSON(a.response);c=c?c:l.ctx,t.debug("ctx: ",c);if(c){var h="";t.debug("save_key: ",n.save_key),n.save_key||(h=u(i,o,e.key_handler),h=h?"/key/"+e.URLSafeBase64Encode(h):"");var d="/fname/"+e.URLSafeBase64Encode(o.name);t.debug("op.x_vars: ",n.x_vars);var v=n.x_vars,m="",g="";if(v!==undefined&&typeof v=="object")for(var y in v)v.hasOwnProperty(y)&&(typeof v[y]=="function"?m=e.URLSafeBase64Encode(v[y](i,o)):typeof v[y]!="object"&&(m=e.URLSafeBase64Encode(v[y])),g+="/x:"+y+"/"+m);var b=s+"/mkfile/"+o.size+h+d+g,w=e.detectIEVersion(),E;w&&w<=9?(E=new mOxie.XMLHttpRequest,mOxie.Env.swf_url=n.flash_swf_url):E=e.createAjax(),E.open("POST",b,!0),E.setRequestHeader("Content-Type","text/plain;charset=UTF-8"),E.setRequestHeader("Authorization","UpToken "+e.token);var S=function(){t.debug("ajax.readyState: ",E.readyState);if(E.readyState===4){localStorage.removeItem(o.name);var e;E.status===200?(e=E.responseText,t.debug("mkfile is success: ",e),f(i,o,e)):(e={status:E.status,response:E.responseText,file:o,code:-200},t.debug("mkfile is error: ",e),p.trigger("Error",e))}};w&&w<=9?E.bind("readystatechange",S):E.onreadystatechange=S,E.send(c),t.debug("mkfile: ",b)}else f(i,o,a.response)}}(l)),t.debug("bind FileUploaded event"),p.init(),t.debug("invoke uploader.init()"),t.debug("init uploader end"),p},this.getUrl=function(e){if(!e)return!1;e=encodeURI(e);var t=this.domain;return t.slice(t.length-1)!=="/"&&(t+="/"),t+e},this.imageView2=function(e,t){var n=e.mode||"",r=e.w||"",i=e.h||"",s=e.q||"",o=e.format||"";if(!n)return!1;if(!r&&!i)return!1;var u="imageView2/"+n;return u+=r?"/w/"+r:"",u+=i?"/h/"+i:"",u+=s?"/q/"+s:"",u+=o?"/format/"+o:"",t&&(u=this.getUrl(t)+"?"+u),u},this.imageMogr2=function(e,t){var n=e["auto-orient"]||"",r=e.thumbnail||"",i=e.strip||"",s=e.gravity||"",o=e.crop||"",u=e.quality||"",a=e.rotate||"",f=e.format||"",l=e.blur||"",c="imageMogr2";return c+=n?"/auto-orient":"",c+=r?"/thumbnail/"+r:"",c+=i?"/strip":"",c+=s?"/gravity/"+s:"",c+=u?"/quality/"+u:"",c+=o?"/crop/"+o:"",c+=a?"/rotate/"+a:"",c+=f?"/format/"+f:"",c+=l?"/blur/"+l:"",t&&(c=this.getUrl(t)+"?"+c),c},this.watermark=function(e,t){var n=e.mode;if(!n)return!1;var r="watermark/"+n;if(n===1){var i=e.image||"";if(!i)return!1;r+=i?"/image/"+this.URLSafeBase64Encode(i):""}else{if(n!==2)return!1;var s=e.text?e.text:"",o=e.font?e.font:"",u=e.fontsize?e.fontsize:"",a=e.fill?e.fill:"";if(!s)return!1;r+=s?"/text/"+this.URLSafeBase64Encode(s):"",r+=o?"/font/"+this.URLSafeBase64Encode(o):"",r+=u?"/fontsize/"+u:"",r+=a?"/fill/"+this.URLSafeBase64Encode(a):""}var f=e.dissolve||"",l=e.gravity||"",c=e.dx||"",h=e.dy||"";return r+=f?"/dissolve/"+f:"",r+=l?"/gravity/"+l:"",r+=c?"/dx/"+c:"",r+=h?"/dy/"+h:"",t&&(r=this.getUrl(t)+"?"+r),r},this.imageInfo=function(e){if(!e)return!1;var t=this.getUrl(e)+"?imageInfo",n=this.createAjax(),r,i=this;return n.open("GET",t,!1),n.onreadystatechange=function(){n.readyState===4&&n.status===200&&(r=i.parseJSON(n.responseText))},n.send(),r},this.exif=function(e){if(!e)return!1;var t=this.getUrl(e)+"?exif",n=this.createAjax(),r,i=this;return n.open("GET",t,!1),n.onreadystatechange=function(){n.readyState===4&&n.status===200&&(r=i.parseJSON(n.responseText))},n.send(),r},this.get=function(e,t){return!t||!e?!1:e==="exif"?this.exif(t):e==="imageInfo"?this.imageInfo(t):!1},this.pipeline=function(e,t){var n=Object.prototype.toString.call(e)==="[object Array]",r,i,s="";if(n){for(var o=0,u=e.length;o<u;o++){r=e[o];if(!r.fop)return!1;switch(r.fop){case"watermark":s+=this.watermark(r)+"|";break;case"imageView2":s+=this.imageView2(r)+"|";break;case"imageMogr2":s+=this.imageMogr2(r)+"|";break;default:i=!0}if(i)return!1}if(t){s=this.getUrl(t)+"?"+s;var a=s.length;s.slice(a-1)==="|"&&(s=s.slice(0,a-1))}return s}return!1}}var e=this;window.localStorage||(window.localStorage={setItem:function(e,n){t(e,n,30)},getItem:function(e){return n(e)},removeItem:function(e){t(e,"",-1)}});var i=new r;e.Qiniu=i,e.QiniuJsSDK=r}),Fengs.add("plus/qiniu",function(e,t,n){t=jQuery;var r=[{name:"moxie",url:"http://cdn.staticfile.org/plupload/2.1.8/moxie.min.js"},{name:"plupload",url:"http://cdn.staticfile.org/Plupload/2.1.1/plupload.min.js"}],i=this,s={image:{title:"Image files",extensions:"jpg,gif,png"},video:{title:"Video files",extensions:"flv,mpg,mpeg,avi,wmv,mov,asf,rm,rmvb,mkv,m4v,mp4"},zip:{title:"Zip files",extensions:"zip"}},o=function(n){var s=this;n=t.extend({token_url:"/cd/qiniu_token",domain:"/",request:{},scope:"scope",limit:"image"},n),n.domain.match(/\/$/)===null&&(n.domain+="/");for(var o in n)s[o]=n[o];return function(n){var o=arguments.callee,u=r[n];u?i[u.name]?o(n+1):e.loadJS(u.url,function(){o(n+1)}):e.use("plus/qiniu-sdk",function(n){e.__qiniu?(s.inited=!0,s.uploader=e.__qiniu):(t("body").append('<div id="qiniuContainer"  style=" position: absolute; left: 0; top: 0;"><a id="qiniuUploadBtn" style=" position: absolute; background-color: rgba(0,0,0,0);width: 0; height: 0; display: block;"></a></div>'),e.__qiniu=s.init())})}(0),s};o.prototype={error:function(){},inited:!1,init:function(){var e=this,r=e.request.p({url:"/api/qiniu_token",data:{scope:e.scope}},!0),s=(new i.QiniuJsSDK).uploader({runtimes:"html5,flash,html4",browse_button:"qiniuUploadBtn",container:"qiniuContainer",drop_element:"qiniuContainer",max_file_size:"1mb",flash_swf_url:"http://cdn.staticfile.org/plupload/2.1.8/Moxie.swf",dragdrop:!1,chunk_size:"4mb",multi_selection:!1,mime_types:[{title:"Image files",extensions:"jpg,gif,png"}],uptoken_func:function(){var t=e.request.p({url:"/cd/qiniu_token",data:{scope:e.scope}},!0),n=new XMLHttpRequest;n.open("GET",t,!1),n.setRequestHeader("If-Modified-Since","0"),n.send();if(n.status===200){var r=JSON.parse(n.responseText);return r.uptoken}return""},domain:e.domain,get_new_uptoken:!0,auto_start:!1,log_level:0,init:{FilesAdded:function(t,n){e.start([n[0]]),t.start([n[0]])},BeforeUpload:function(t,n){e.uploading=!0},UploadProgress:function(t,n){var r=plupload.parseSize(this.getOption("chunk_size"));e.progress(n.percent,n.speed,r)},FileUploaded:function(n,r,i){e.uploading=!1;var s=t.parseJSON(i),o=e.domain+s.key;e.finish(o)},Error:function(t,n,r){e.uploading=!1,e.error(r)},Key:function(r,i){if(t.isFunction(e.key))return e.scope+"/"+e.key(i);var s=e.scope+"/";return s+=n().format("YYYYMMDDHHmmss"),s+="."+i.type.match(/\/([a-z0-9]+)$/)[1],s}}});return s.bind("FileUploaded",function(e,t,n){return!1}),e.uploader=s,e.inited=!0,s},uploading:!1,start:function(e){},progress:function(e,t,n){},finish:function(e){},bind:function(e,n){var r=this,i=arguments.callee,s=t.extend({start:function(e){},progress:function(e,t,n){},finish:function(e){},error:function(e){}},n);return e?(e=t(e),r.inited?(e.on("click",function(){if(r.uploading)return r.error("\u7ec4\u4ef6\u6b63\u5728\u4e0a\u4f20\u4e2d...");for(var e in s)r[e]=s[e]}).on("mouseenter",function(){var n=e.offset();t("#qiniuUploadBtn").css({width:e.outerWidth(),height:e.outerHeight(),left:n.left,top:n.top}),t("#qiniuUploadBtn").data("target",e)}),s):setTimeout(function(){i(e,n)},200)):(s.error("\u4e0d\u5b58\u5728\u7684DOM\u5143\u7d20"),null)}};var u=function(){t("#qiniuUploadBtn").css({width:0,height:0,left:0})};return t("body").on("mouseleave","#qiniuUploadBtn",u).on("click","#qiniuUploadBtn",function(){t(this).data("target").trigger("click"),u()}),o},["./moment"])